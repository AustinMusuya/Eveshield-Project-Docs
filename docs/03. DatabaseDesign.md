# EveShield MVP ‚Äì Database Design

This document outlines the core data entities and their relationships for both the USSD and Offline Android App MVPs. The database design prioritizes simplicity, user privacy, and support for offline-first behavior.

---

## üîπ Core Entities

### 1. **User**

> Represents a person interacting with the system, either via USSD or the Android app.

| Field          | Type          | Description                                                     |
| -------------- | ------------- | --------------------------------------------------------------- |
| `user_id`      | UUID/String   | Unique identifier (auto-generated or derived from phone number) |
| `phone_number` | String        | User‚Äôs mobile number (masked/anonymized if needed)              |
| `device_type`  | Enum          | `feature_phone` or `smartphone`                                 |
| `location`     | GeoPoint/JSON | Last known coordinates (if available)                           |
| `created_at`   | Timestamp     | Registration or first interaction time                          |

---

### 2. **SOS Alert**

> Captures emergency signals triggered by a user.

| Field        | Type      | Description                                             |
| ------------ | --------- | ------------------------------------------------------- |
| `alert_id`   | UUID      | Unique alert identifier                                 |
| `user_id`    | UUID      | Linked to the User entity                               |
| `alert_type` | Enum      | `panic_button`, `menu_triggered`, `bluetooth_triggered` |
| `status`     | Enum      | `sent`, `pending`, `offline_stored`, `retried`          |
| `timestamp`  | Timestamp | When the alert was generated                            |
| `location`   | GeoPoint  | GPS coordinates (if available)                          |

---

### 3. **Support Resource**

> Contains crisis response or support content delivered via USSD or app (e.g. emergency numbers, legal advice, shelters).

| Field           | Type   | Description                                     |
| --------------- | ------ | ----------------------------------------------- |
| `resource_id`   | UUID   | Unique identifier                               |
| `title`         | String | Resource name or category                       |
| `body`          | Text   | Description or details                          |
| `region`        | String | Location relevance (e.g., Nairobi, Rift Valley) |
| `access_method` | Enum   | `USSD`, `App`, or `Both`                        |

---

### 4. **Bluetooth Relay Log** _(App only)_

> Logs alert packets relayed via Bluetooth mesh.

| Field         | Type      | Description                         |
| ------------- | --------- | ----------------------------------- |
| `relay_id`    | UUID      | Unique relay identifier             |
| `source_user` | UUID      | Sender user ID                      |
| `target_user` | UUID      | Recipient user ID                   |
| `hop_count`   | Integer   | Number of hops from original source |
| `timestamp`   | Timestamp | Time of relay                       |

---

### 5. **Session Log** _(USSD only)_

> Tracks USSD interactions for analytics or debug.

| Field        | Type       | Description                        |
| ------------ | ---------- | ---------------------------------- |
| `session_id` | UUID       | Unique session identifier          |
| `user_id`    | UUID       | Linked user                        |
| `menu_path`  | Array/Text | Sequence of menu options navigated |
| `duration`   | Integer    | Time spent in session (seconds)    |
| `timestamp`  | Timestamp  | When the session occurred          |

---

## üîó Entity Relationships

- **User ‚Üí SOS Alert**: One-to-many (a user can trigger many alerts)

- **User ‚Üí Session Log**: One-to-many (for USSD tracking)

- **User ‚Üí Bluetooth Relay Log**: One-to-many (a user can relay or receive alerts)

- **Support Resource ‚Üí Users**: Many-to-many indirectly (users access multiple resources)

- **SOS Alert ‚Üí Relay Log**: One-to-many (an alert can be relayed across multiple devices)

---

## üìù Notes

- Personally identifiable data (like phone numbers) should be encrypted or hashed where feasible.

- For offline mode, the Android app will locally cache SOS alerts and sync when back online.

- Lightweight databases (e.g., **MongoDB for backend**, **Room for mobile**) are ideal for MVP.

- Consider partitioning data by region if scalability becomes a concern post-MVP.
